/*
 * AppNexus HTML5 library
 * Author: Alejandro Gonzalez Sole (jgonzalezsole@appnexus.com) 
 * Website: http://www.appnexus.com
 * MIT Licensed.
 *
 * appnexus-html5-lib 0.0.0
 */
 !function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.PortholeClass=function(){},PortholeClass.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}(),function(a){"use strict";var b={debug:!1,trace:function(b){this.debug&&void 0!==a.console&&a.console.log("Porthole: "+b)},error:function(b){void 0!==typeof a.console&&"function"==typeof a.console.error&&a.console.error("Porthole: "+b)}};b.WindowProxy=function(){},b.WindowProxy.prototype={post:function(a,b){},addEventListener:function(a){},removeEventListener:function(a){}},b.WindowProxyBase=PortholeClass.extend({init:function(b){void 0===b&&(b=""),this.targetWindowName=b,this.origin=a.location.protocol+"//"+a.location.host,this.eventListeners=[]},getTargetWindowName:function(){return this.targetWindowName},getOrigin:function(){return this.origin},getTargetWindow:function(){return b.WindowProxy.getTargetWindow(this.targetWindowName)},post:function(b,c){void 0===c&&(c="*"),this.dispatchMessage({data:b,sourceOrigin:this.getOrigin(),targetOrigin:c,sourceWindowName:a.name,targetWindowName:this.getTargetWindowName()})},addEventListener:function(a){return this.eventListeners.push(a),a},removeEventListener:function(a){var b;try{b=this.eventListeners.indexOf(a),this.eventListeners.splice(b,1)}catch(c){this.eventListeners=[]}},dispatchEvent:function(a){var c;for(c=0;c<this.eventListeners.length;c++)try{this.eventListeners[c](a)}catch(d){b.error(d)}}}),b.WindowProxyLegacy=b.WindowProxyBase.extend({init:function(a,c){this._super(c),null!==a?(this.proxyIFrameName=this.targetWindowName+"ProxyIFrame",this.proxyIFrameLocation=a,this.proxyIFrameElement=this.createIFrameProxy()):(this.proxyIFrameElement=null,b.trace("proxyIFrameUrl is null, window will be a receiver only"),this.post=function(){throw new Error("Receiver only window")})},createIFrameProxy:function(){var a=document.createElement("iframe");return a.setAttribute("id",this.proxyIFrameName),a.setAttribute("name",this.proxyIFrameName),a.setAttribute("src",this.proxyIFrameLocation),a.setAttribute("frameBorder","1"),a.setAttribute("scrolling","auto"),a.setAttribute("width",30),a.setAttribute("height",30),a.setAttribute("style","position: absolute; left: -100px; top:0px;"),a.style.setAttribute&&a.style.setAttribute("cssText","position: absolute; left: -100px; top:0px;"),document.body.appendChild(a),a},dispatchMessage:function(c){var d=a.encodeURIComponent;if(this.proxyIFrameElement){var e=this.proxyIFrameLocation+"#"+d(b.WindowProxy.serialize(c));this.proxyIFrameElement.setAttribute("src",e),this.proxyIFrameElement.height=this.proxyIFrameElement.height>50?50:100}}}),b.WindowProxyHTML5=b.WindowProxyBase.extend({init:function(a,b){this._super(b),this.eventListenerCallback=null},dispatchMessage:function(a){this.getTargetWindow().postMessage(b.WindowProxy.serialize(a),a.targetOrigin)},addEventListener:function(b){if(0===this.eventListeners.length){var c=this;a.addEventListener?(this.eventListenerCallback=function(a){c.eventListener(c,a)},a.addEventListener("message",this.eventListenerCallback,!1)):a.attachEvent&&(this.eventListenerCallback=function(b){c.eventListener(c,a.event)},a.attachEvent("onmessage",this.eventListenerCallback))}return this._super(b)},removeEventListener:function(b){this._super(b),0===this.eventListeners.length&&(a.removeEventListener?a.removeEventListener("message",this.eventListenerCallback):a.detachEvent&&("undefined"==typeof a.onmessage&&(a.onmessage=null),a.detachEvent("onmessage",this.eventListenerCallback)),this.eventListenerCallback=null)},eventListener:function(a,c){var d=b.WindowProxy.unserialize(c.data);!d||""!==a.targetWindowName&&d.sourceWindowName!=a.targetWindowName||a.dispatchEvent(new b.MessageEvent(d.data,c.origin,a))}}),a.postMessage?(b.trace("Using built-in browser support"),b.WindowProxy=b.WindowProxyHTML5.extend({})):(b.trace("Using legacy browser support"),b.WindowProxy=b.WindowProxyLegacy.extend({})),b.WindowProxy.serialize=function(a){if("undefined"==typeof JSON)throw new Error("Porthole serialization depends on JSON!");return JSON.stringify(a)},b.WindowProxy.unserialize=function(a){if("undefined"==typeof JSON)throw new Error("Porthole unserialization dependens on JSON!");try{var b=JSON.parse(a)}catch(c){return!1}return b},b.WindowProxy.getTargetWindow=function(b){return""===b?parent:"top"===b||"parent"===b?a[b]:a.frames[b]},b.MessageEvent=function(a,b,c){this.data=a,this.origin=b,this.source=c},b.WindowProxyDispatcher={forwardMessageEvent:function(c){var d,e,f,g=a.decodeURIComponent;document.location.hash.length>0&&(d=b.WindowProxy.unserialize(g(document.location.hash.substr(1))),e=b.WindowProxy.getTargetWindow(d.targetWindowName),f=b.WindowProxyDispatcher.findWindowProxyObjectInWindow(e,d.sourceWindowName),f?f.origin===d.targetOrigin||"*"===d.targetOrigin?f.dispatchEvent(new b.MessageEvent(d.data,d.sourceOrigin,f)):b.error("Target origin "+f.origin+" does not match desired target of "+d.targetOrigin):b.error("Could not find window proxy object on the target window"))},findWindowProxyObjectInWindow:function(a,b){var c;if(a)for(c in a)if(Object.prototype.hasOwnProperty.call(a,c))try{if(null!==a[c]&&"object"==typeof a[c]&&a[c]instanceof a.Porthole.WindowProxy&&a[c].getTargetWindowName()===b)return a[c]}catch(d){}return null},start:function(){a.addEventListener?a.addEventListener("resize",b.WindowProxyDispatcher.forwardMessageEvent,!1):a.attachEvent&&"undefined"!==a.postMessage?a.attachEvent("onresize",b.WindowProxyDispatcher.forwardMessageEvent):document.body.attachEvent?a.attachEvent("onresize",b.WindowProxyDispatcher.forwardMessageEvent):b.error("Cannot attach resize event")}},"undefined"!=typeof a.exports?a.exports.Porthole=b:a.Porthole=b}(this)},{}],2:[function(a,b,c){"use strict";function d(){}a("ternarylabs-porthole/src/porthole.js");b.exports=d},{"ternarylabs-porthole/src/porthole.js":1}]},{},[2]);